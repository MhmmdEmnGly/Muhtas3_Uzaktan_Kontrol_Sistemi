<!DOCTYPE html>
<html lang="en">


<head>



    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Akıllı Kontrol Sistemi || </title>

    <!-- ======= JQUERY Connection ====== -->
    <script src="https://code.jquery.com/jquery-3.6.3.js"
        integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM=" crossorigin="anonymous">
        </script>

    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script> -->

    <!-- <script src="jquery-3.6.1.min.js"></script> -->
    <!-- ======= Styles ====== -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- =============== Navigation ================ -->
    <div class="container">
        <div class="navigation">
            <ul>
                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="logo-apple"></ion-icon>
                        </span>
                        <span class="title"><i> Uzaktan Kontrol Sistemi</i></span>
                    </a>
                </li>

                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="home-outline"></ion-icon>
                        </span>
                        <span class="title"><h3>Kontrol Paneli</h3></span>
                    </a>
                </li>

                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="log-out-outline"></ion-icon>
                        </span>
                        <span class="title"><h3>Çıkış</h2> </span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- ========================= Main ==================== -->
        <div class="main">
            <div class="topbar">
                <!-- <div class="toggle">
                    <ion-icon name="menu-outline"></ion-icon>
                </div> -->
                

            </div>

            <!-- ======================= Cards ================== -->
            <div class="cardBox" ; style="background-color: #242424;">
                <div class="card">
                    <div>
                        <div id="temp" class="numbers">34 C° </div> <!--  sıcaklık verisi = temperature -->
                        <div class="cardName">
                            <h3 style="color:#a2bdee">Sıcaklık</h3>
                        </div>

                    </div>

                    <div class="iconBx">

                    </div>
                </div>

                <div class="card">
                    <div>
                        <div id="nem" class="numbers">37 %</div>
                        <div class="cardName">
                            <h3 style="color:#a2bdee">Nem</h3>
                        </div>
                    </div>

                    <div class="iconBx">

                    </div>
                </div>

                <div class="card">
                    <div>
                        <div class="numbers">
                            <h5 id="fanTitle" style="color:red">Kapalı</h5>
                        </div>
                        <div class="cardName">
                            <h3 style="color:#a2bdee">Fan</h3>
                        </div>
                    </div>

                    <div class="iconBx">

                    </div>
                </div>

                <div class="card">
                    <div>
                        <div class="numbers">
                            <h5 id="lambaTitle" style="color:red">Kapalı</h5>
                        </div>
                        <div class="cardName">
                            <h3 style="color:#a2bdee">Lamba</h3>
                        </div>
                    </div>

                    <div class="iconBx">

                    </div>
                </div>
            </div>

            <!-- ================ Order Details List ================= -->
            <div class="details">
                <div class="recentOrders">
                    <div class="cardHeader">
                        <h2>Sensör Durumları</h2>

                    </div>

                    <table>
                        <thead>
                            <tr>
                                <td>Sensör</td>
                                <td></td>
                                <td>Sensör Verisi</td>
                                <td>On/Off</td>
                            </tr>
                        </thead>

                        <tbody>
                            <tr>
                                <td>Sıcaklık</td>
                                <td></td>
                                <td id="sicaklikDurum"> 24 C°</td>
                                <td><span class="status acik">Aktif</span></td>
                                <!-- buraya id degeri yazdım js de onu  degistircem degil mi -->
                            </tr>

                            <tr>
                                <td>Nem</td>
                                <td></td>
                                <td id="nemDurum">40 %</td>
                                <td><span class="status acik">Aktif</span></td>
                            </tr>

                            <tr>
                                <td>Fan Durumu</td>
                                <td></td>
                                <td id="fanDurum">0</td>
                                <td ><span id="fanOnOff" class="status kapali">Kapalı </span></td>
                            </tr>


                            <tr>
                                <td>Yağmur Durumu</td>
                                <td></td>
                                <td id="yagmurDurum">Yağmur Yok</td>
                                <td><span class="status acik">Aktif</span></td>
                            </tr>

                            <tr>
                                <td>Hareket Durumu</td>
                                <td></td>
                                <td id="hareketDurum">0</td>
                                <td><span id="hareketOnOff" class="status kapali">Kapalı</span></td>
                            </tr>

                            <tr>
                                <td>Lamba Durumu</td>
                                <td></td>
                                <td id="lambaDurum">Lamba Açık</td>
                                <td><span id="lambaOnOff" class="status acik">Aktif</span></td>
                            </tr>

                            <tr>
                                <td>Işık Durumu</td>
                                <td></td>
                                <td id="isikDurum">0</td>
                                <td><span id="isikOnOff" class="status kapali">Kapalı</span></td>
                            </tr>

                            <tr>
                                <td>Bahce Durumu</td>
                                <td></td>
                                <td id="touchDurum">0</td>
                                <td><span id="touchOnOff" class="status kapali">Kapalı</span></td>
                            </tr>
                            
                            <tr>
                                <td>Motor Durumu</td>
                                <td></td>
                                <td id="servoDurum">0</td>
                                <td><span id="servoOnOff" class="status kapali">Kapalı</span></td>
                            </tr>

                        </tbody>
                    </table>
                </div>

                <!-- ================= New Customers ================ -->
                <div class="recentCustomers">

                    <div class="cardHeader">
                        <h2 style="color:darkorange">Uzaktan Kontrol </h2>
                    </div>
                    <br>

                    <table>

                        <tr> <!--  tr satır demek td sutun -->
                            <br>
                            <h2 style="color:#1795ce">Servo Motor</h2>

                            <td width="60px">
                                <button id="btnServo" onclick=ServoRunOrStop() class="button">Çalıştır</button>


                            </td>


                            <td>
                                <h3 id="servoUzaktanKontrol"  style="color:red"> KAPALI </h3>
                            </td>
                        </tr>

                        <!-- lamba kısmı    -->
                        <tr>
                            <td>
                                <br>
                                <h2 style="color:#1795ce" ;> Lamba</h2>

                            </td>

                        </tr>

                        <tr>
                            <td width="60px">
                                <button id="btnLamba" onclick=lambaRunOrStop() class="button">Çalıştır</button>


                            </td>


                            <td>
                                <h3 id="lambaUzaktanKontrol" ; style="color:red"> KAPALI </h3>
                            </td>

                        </tr>
                        <!-- LAMBA BİTİŞ-->

                        <!-- FAN BASLANGIC-->
                        <tr>
                            <td>
                                <br>
                                <h2  style="color:#1795ce" ;> Fan</h2> 

                            </td>

                        </tr>

                        <tr>
                            <td width="60px">
                                <button id="btnFan" onclick=fanRunOrStop() class="button">Çalıştır</button>


                            </td>


                            <td>
                                <h3 id="fanUzaktanKontrol" ; style="color:red"> KAPALI </h3>
                            </td>

                        </tr>
                        <!-- FAN BITIS-->

                    </table>
                </div>
            </div>
        </div>
    </div>



    <!-- =========== Scripts =========  -->
    <script>
        var servobutondeger=0
        var lambabutondeger=0
        var fanbutondeger=0

        function ServoRunOrStop() {
            servobutondeger++


            $.ajax({
                url: 'http://localhost:9000/servo',
                crossDomain: true,
                dataType: 'json',
                type: 'POST',
                contentType: 'application/json',
                "headers": {
              "accept": "application/json",
              "Access-Control-Allow-Origin":"*"
          },
                data: JSON.stringify({status:(servobutondeger%2) }),
                processData: false,
                success: function (response) {
                //success: function (data, textStatus, jQxhr) {
                    //$('#response pre').html(JSON.stringify(data));


                    
                },
                error: function (jqXhr, textStatus, errorThrown) {
                    console.log(errorThrown);
                }
            });
                
        }

        function lambaRunOrStop() {
            lambabutondeger++


            $.ajax({
                url: 'http://localhost:9000/lamba',
                crossDomain: true,
                dataType: 'json',
                type: 'POST',
                contentType: 'application/json',
                "headers": {
              "accept": "application/json",
              "Access-Control-Allow-Origin":"*"
          },
                data: JSON.stringify({status:(lambabutondeger%2) }),
                processData: false,
                success: function (response) {
                //success: function (data, textStatus, jQxhr) {
                    //$('#response pre').html(JSON.stringify(data));


                    
                },
                error: function (jqXhr, textStatus, errorThrown) {
                    console.log(errorThrown);
                }
            });
                
        }

        function fanRunOrStop() {
            fanbutondeger++


            $.ajax({
                url: 'http://localhost:9000/fan',
                crossDomain: true,
                dataType: 'json',
                type: 'POST',
                contentType: 'application/json',
                "headers": {
              "accept": "application/json",
              "Access-Control-Allow-Origin":"*"
          },
                data: JSON.stringify({status:(fanbutondeger%2) }),
                processData: false,
                success: function (response) {
                //success: function (data, textStatus, jQxhr) {
                    //$('#response pre').html(JSON.stringify(data));


                    
                },
                error: function (jqXhr, textStatus, errorThrown) {
                    console.log(errorThrown);
                }
            });
                
        }
        


        //     $.post("http://localhost:9000/servo", {
        //         "status": "1"
        //     }, (data, status) => {

        //         alert("data: ", data, "\nstatus:", status);
        //     })
        // }




        $(document).ready(function () {

            setInterval(function () {
                $.ajax({
                    url: "http://localhost:9000/sicaklik",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        $('#temp').text(response.sicaklik + " C°");
                        $('#sicaklikDurum').text(response.sicaklik + " C°");


                    },
                    error: function (xhr, status) {
                        console.log("status: " + status)
                        console.log("xhr: " + xhr)

                        alert("error");
                    }
                });


                $.ajax({
                    url: "http://localhost:9000/nem",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        $('#nem').text(response.nem + " %");
                        $('#nemDurum').text(response.nem + " %");

                    },
                    error: function (xhr, status) {
                        alert("error");
                    }
                });

            }, 3000);

            // setInterval(function () {
            //     $.ajax({
            //         url: "http://localhost:9000/nem",
            //         type: "GET",
            //         crossDomain: true,
            //         dataType: "json",
            //         success: function (response) {

            //             $('#nem').text(response.nem + " %");
            //             $('#nemDurum').text(response.nem + " %");

            //         },
            //         error: function (xhr, status) {
            //             alert("error");
            //         }
            //     });
            // }, 3000);


            setInterval(function () {
                $.ajax({
                    url: "http://localhost:9000/yagmur",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        if (response.yagmur == 0) {
                            $('#yagmurDurum').text("Yagmur Yok");
                        }
                        else {
                            $('#yagmurDurum').text("Hava Yagisli");
                        }


                    },
                    error: function (xhr, status) {
                        alert("error");
                    }
                });
            }, 3000);


            setInterval(function () {
                $.ajax({
                    url: "http://localhost:9000/fan",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        if (response.fan == 0) {
                            $('#fanDurum').text(response.fan);
                            $('#fanOnOff').text("Kapalı");
                            $('#fanOnOff').removeClass("status acik");
                            $('#fanOnOff').addClass("status kapali");

                            $('#fanTitle').text("Kapalı");
                            $('#fanTitle').css("color","red");

                            $('#fanUzaktanKontrol').text("KAPALI");
                            $('#fanUzaktanKontrol').css("color","red");

                            $('#btnFan').text("Çalıştır");
                            $('#btnFan').removeClass("button close")
                            $('#btnFan').addClass("button")

                            

                            

                            // <span class="status kapali">Kapalı</span>
                        }
                        else {
                            $('#fanDurum').text("Çalışıyor");
                            $('#fanOnOff').removeClass("status kapali");
                            $('#fanOnOff').addClass("status acik");
                            $('#fanOnOff').text("Aktif");

                            $('#fanTitle').text("Açık");
                            $('#fanTitle').css("color","#3e8e41");

                            $('#fanUzaktanKontrol').text("AÇIK");
                            $('#fanUzaktanKontrol').css("color","green");

                            $('#btnFan').text("  Kapat  ");
                            $('#btnFan').removeClass("button")
                            $('#btnFan').addClass("button close")

                            
                            

                            
                            
                            



                            //$('#fanOnOff').html(<span class="status acik">Açık</span>)
                            // kırmızı *kapalı* yazan on off durumu fan çalısınca yeşile donsun aktif yazsin 
                        }


                    },
                    error: function (xhr, status) {
                        alert("error");
                    }
                });
            }, 3000);

            // hareket
            setInterval(function () {    // hareket kapatılabilir olsun
                $.ajax({
                    url: "http://localhost:9000/hareket",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        if (response.hareket == 0) {
                            $('#hareketDurum').text(response.hareket);
                            $('#hareketOnOff').text("Aktif");
                            $('#hareketOnOff').removeClass("status kapali"); // renk degeri
                            $('#hareketOnOff').addClass("status acik");
                            

                            //!-- hareket sensorunu kapatabilme ozelligimiz olsun

                        }
                        else {
                            $('#hareketDurum').text("Bir Hareket Algılandı");
                            $('#hareketOnOff').text("Aktif");
                            $('#hareketOnOff').removeClass("status kapali"); // renk degeri
                            $('#hareketOnOff').addClass("status acik");

                        }


                    },
                    error: function (xhr, status) {
                        alert("error");
                    }
                });
            }, 3000);

            //lamba
            setInterval(function () {     //On Off düzenle


                $.ajax({
                    url: "http://localhost:9000/lamba",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        if (response.lamba == 0) {
                            $('#lambaDurum').text(response.lamba);
                            $('#lambaOnOff').text("Kapalı");
                            $('#lambaOnOff').removeClass("status acik"); // renk degeri
                            $('#lambaOnOff').addClass("status kapali");

                            $('#lambaTitle').text("Kapalı");
                            $('#lambaTitle').css("color","red");

                            $('#lambaUzaktanKontrol').text("KAPALI");
                            $('#lambaUzaktanKontrol').css("color","red");

                            $('#btnLamba').text("Çalıştır");
                            $('#btnLamba').removeClass("button close")
                            $('#btnLamba').addClass("button")


                            // kapalı durumunda on off kısmını kırmızı hale getirip kapalı yazısı yazdır
                        }
                        else {
                            $('#lambaDurum').text("Lamba Açık");
                            $('#lambaOnOff').text("Aktif");
                            $('#lambaOnOff').removeClass("status kapali"); // renk degeri
                            $('#lambaOnOff').addClass("status acik");


                            $('#lambaTitle').text("Açık");
                            $('#lambaTitle').css("color","green");

                            $('#lambaUzaktanKontrol').text("AÇIK");
                            $('#lambaUzaktanKontrol').css("color","green");

                            $('#btnLamba').text("Kapat");
                            $('#btnLamba').removeClass("button")
                            $('#btnLamba').addClass("button close")

                        }


                    },
                    error: function (xhr, status) {
                        alert("error");
                    }
                });
            }, 3000);

            //isik
            setInterval(function () {     //On Off düzenle
                $.ajax({
                    url: "http://localhost:9000/isik",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        if (response.isik == 1) {
                            $('#isikDurum').text(" Karanlık");
                            $('#isikOnOff').text("Aktif");
                            $('#isikOnOff').removeClass("status kapali"); 
                            $('#isikOnOff').addClass("status acik");
                            


                            // kapalı durumunda on off kısmını kırmızı hale getirip kapalı yazısı yazdır
                        }
                        else {
                            $('#isikDurum').text("Aydınlık");
                            $('#isikOnOff').text("Aktif");
                            $('#isikOnOff').removeClass("status kapali"); // renk degeri
                            $('#isikOnOff').addClass("status acik");

                        }


                    },
                    error: function (xhr, status) {
                        alert("error");
                    }
                });
            }, 3000);

            //bahce --touch sensor
            setInterval(function () {     //On Off düzenle
                $.ajax({
                    url: "http://localhost:9000/touch",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        if (response.touch == 1) {
                            $('#touchDurum').text("Bahcede Hareket Algilandi");
                            $('#touchOnOff').text("Aktif");
                            $('#touchOnOff').removeClass("status kapali"); 
                            $('#touchOnOff').addClass("status acik");
                            


                            // kapalı durumunda on off kısmını kırmızı hale getirip kapalı yazısı yazdır
                        }
                        else {
                            $('#touchDurum').text("Hareket Yok");
                            $('#touchOnOff').text("Aktif");
                            $('#touchOnOff').removeClass("status kapali"); // renk degeri
                            $('#touchOnOff').addClass("status acik");

                        }


                    },
                    error: function (xhr, status) {
                        alert("error");
                    }
                });
            }, 3000);

            // servo                       //!-- NNOT SEVO ILE MOTOR AYNI VERIYI CEKIYOR
            setInterval(function () {     //On Off düzenle
                $.ajax({
                    url: "http://localhost:9000/servo",
                    type: "GET",
                    crossDomain: true,
                    dataType: "json",
                    success: function (response) {

                        if (response.servo == 1) {
                            $('#servoDurum').text(" Motor Dönüyor");
                            $('#servoOnOff').text("Aktif");
                            $('#servoOnOff').removeClass("status kapali"); 
                            $('#servoOnOff').addClass("status acik");

                            $('#servoUzaktanKontrol').text("AÇIK");
                            $('#servoUzaktanKontrol').css("color","green");

                            $('#btnServo').text("Kapat");
                            $('#btnServo').removeClass("button")
                            $('#btnServo').addClass("button close")
                            


                            // kapalı durumunda on off kısmını kırmızı hale getirip kapalı yazısı yazdır
                        }
                        else {
                            $('#servoDurum').text("Sabit");
                            $('#servoOnOff').text("Kapalı");
                            $('#servoOnOff').removeClass("status acik"); // renk degeri
                            $('#servoOnOff').addClass("status kapali");

                            $('#servoUzaktanKontrol').text("KAPALI");
                            $('#servoUzaktanKontrol').css("color","red");

                            $('#btnServo').text("Çalıştır");
                            $('#btnServo').removeClass("button close")
                            $('#btnServo').addClass("button")


                            


                        }


                    },
                    error: function (xhr, status) {
                        alert("error");
                    }
                });
            }, 3000);



        });



        // var nem = 46;
        // $("#bilal").text(nem);
        // var temperature = 19;
        // $('#temp').text(temperature);
    </script>

    <!-- ====== ionicons ======= -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
</body>

</html>